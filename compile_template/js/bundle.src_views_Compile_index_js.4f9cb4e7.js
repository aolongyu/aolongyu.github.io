"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */(self.webpackChunkcomplie_template=self.webpackChunkcomplie_template||[]).push([["src_views_Compile_index_js"],{
/***/"./node_modules/.pnpm/mini-css-extract-plugin@2.9.2_webpack@5.101.0/node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/.pnpm/css-loader@7.1.2_webpack@5.101.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/.pnpm/sass-loader@16.0.5_sass@1.89.2_webpack@5.101.0/node_modules/sass-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/mini-css-extract-plugin@2.9.2_webpack@5.101.0/node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/.pnpm/css-loader@7.1.2_webpack@5.101.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/.pnpm/sass-loader@16.0.5_sass@1.89.2_webpack@5.101.0/node_modules/sass-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("{__webpack_require__.r(__webpack_exports__);\n// extracted by mini-css-extract-plugin\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/compile.vue?./node_modules/.pnpm/mini-css-extract-plugin@2.9.2_webpack@5.101.0/node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/.pnpm/css-loader@7.1.2_webpack@5.101.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/.pnpm/sass-loader@16.0.5_sass@1.89.2_webpack@5.101.0/node_modules/sass-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options\n}");
/***/},
/***/"./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=script&lang=js":
/*!**********************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=script&lang=js ***!
  \**********************************************************************************************************************************************************************************************************************************************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _utils_scheduler_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/utils/scheduler.js */ "./src/utils/scheduler.js");\n/* harmony import */ var _helper_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./helper.js */ "./src/views/Compile/helper.js");\n/* harmony import */ var _config_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config.js */ "./src/views/Compile/config.js");\n/* harmony import */ var ace_builds__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ace-builds */ "./node_modules/.pnpm/ace-builds@1.43.2/node_modules/ace-builds/src-noconflict/ace.js");\n/* harmony import */ var ace_builds__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(ace_builds__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var ace_builds_src_noconflict_mode_vue__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ace-builds/src-noconflict/mode-vue */ "./node_modules/.pnpm/ace-builds@1.43.2/node_modules/ace-builds/src-noconflict/mode-vue.js");\n/* harmony import */ var ace_builds_src_noconflict_mode_vue__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(ace_builds_src_noconflict_mode_vue__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var ace_builds_src_noconflict_theme_monokai__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ace-builds/src-noconflict/theme-monokai */ "./node_modules/.pnpm/ace-builds@1.43.2/node_modules/ace-builds/src-noconflict/theme-monokai.js");\n/* harmony import */ var ace_builds_src_noconflict_theme_monokai__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(ace_builds_src_noconflict_theme_monokai__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var ace_builds_src_noconflict_ext_language_tools__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ace-builds/src-noconflict/ext-language_tools */ "./node_modules/.pnpm/ace-builds@1.43.2/node_modules/ace-builds/src-noconflict/ext-language_tools.js");\n/* harmony import */ var ace_builds_src_noconflict_ext_language_tools__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(ace_builds_src_noconflict_ext_language_tools__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n\n\nconst scheduler = new _utils_scheduler_js__WEBPACK_IMPORTED_MODULE_0__["default"]();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  name: "Compile",\n\n  data: () => ({\n    text: "",\n    aceEditor: null,\n    cRender: null,\n\n    loading: true,\n    timeline: [],\n\n    control: {\n      isShowDrawer: false,\n      drawerActiveTab: "log",\n    },\n  }),\n\n  created() {\n    this.text = _config_js__WEBPACK_IMPORTED_MODULE_2__.text;\n  },\n\n  mounted() {\n    this.initAceEditor();\n  },\n\n  methods: {\n    getLines() {\n      const height = this.$refs.containerRef.clientHeight;\n      return height / 16;\n    },\n    initAceEditor() {\n      const lines = this.getLines();\n      this.aceEditor = ace_builds__WEBPACK_IMPORTED_MODULE_3___default().edit(this.$refs.editor, {\n        maxLines: lines,\n        minLines: lines,\n        mode: "ace/mode/vue",\n        tabSize: 2,\n        selectionStyle: "text",\n        ext: ["language_tools"],\n        value: this.text,\n        theme: "ace/theme/monokai",\n      });\n    },\n    onComplieClick() {\n      this.control.isShowDrawer = true;\n    },\n    onCloseClick() {\n      this.control.isShowDrawer = false;\n    },\n    onDrawerOpened() {\n      this.cRender = new _helper_js__WEBPACK_IMPORTED_MODULE_1__.ComponentRender(\n        this.$refs.renderContainer,\n        this.addTimeline\n      );\n      const text = this.aceEditor.getValue();\n      this.cRender.render(text, {\n        props: {\n          subTitle: "myTitle",\n        },\n        events: {\n          loaded: this.loaded,\n          click: this.onClick,\n        },\n      });\n    },\n    onDrawerClosed() {\n      this.control.drawerActiveTab = "log";\n      this.cRender.destroy();\n      this.cRender = null;\n      this.timeline = [];\n    },\n    addTimeline({ status, done = false }, title = "", content = "", ...others) {\n      scheduler.add(() => {\n        // console.warn(`${this.timeline.length + 1}.log: `, title, content, others);\n        this.timeline.unshift({\n          timestamp: new Date().toLocaleString(),\n          type: status,\n          title,\n          content,\n          others,\n        });\n        this.loading = !done;\n      });\n    },\n    loaded(e) {\n      console.log("loaded", e);\n    },\n    onClick(e) {\n      console.log("click", e);\n    },\n  },\n});\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/compile.vue?./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options\n}');
/***/},
/***/"./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[1]!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=template&id=a4ad38e6&scoped=true":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[1]!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=template&id=a4ad38e6&scoped=true ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   render: () => (/* binding */ render),\n/* harmony export */   staticRenderFns: () => (/* binding */ staticRenderFns)\n/* harmony export */ });\nvar render = function render() {\n  var _vm = this,\n    _c = _vm._self._c\n  return _c(\n    "div",\n    { ref: "containerRef", staticClass: "container" },\n    [\n      _c("div", { ref: "editor" }),\n      _vm._v(" "),\n      _c(\n        "el-button",\n        {\n          staticClass: "btn",\n          attrs: { icon: "el-icon-position", type: "primary" },\n          on: { click: _vm.onComplieClick },\n        },\n        [_vm._v("执行")]\n      ),\n      _vm._v(" "),\n      _c(\n        "el-drawer",\n        {\n          attrs: {\n            "custom-class": "drawer",\n            size: "100%",\n            direction: "btt",\n            "with-header": false,\n            "destroy-on-close": true,\n            visible: _vm.control.isShowDrawer,\n          },\n          on: {\n            "update:visible": function ($event) {\n              return _vm.$set(_vm.control, "isShowDrawer", $event)\n            },\n            opened: _vm.onDrawerOpened,\n            closed: _vm.onDrawerClosed,\n          },\n        },\n        [\n          _c(\n            "div",\n            {\n              staticStyle: {\n                display: "flex",\n                "flex-direction": "column",\n                height: "100%",\n              },\n            },\n            [\n              _c(\n                "el-header",\n                { staticClass: "header" },\n                [\n                  _c("div", { staticClass: "title" }, [_vm._v("执行")]),\n                  _vm._v(" "),\n                  _c("el-button", {\n                    attrs: { icon: "el-icon-close" },\n                    on: { click: _vm.onCloseClick },\n                  }),\n                ],\n                1\n              ),\n              _vm._v(" "),\n              _c(\n                "el-main",\n                [\n                  _c(\n                    "el-tabs",\n                    {\n                      model: {\n                        value: _vm.control.drawerActiveTab,\n                        callback: function ($$v) {\n                          _vm.$set(_vm.control, "drawerActiveTab", $$v)\n                        },\n                        expression: "control.drawerActiveTab",\n                      },\n                    },\n                    [\n                      _c(\n                        "el-tab-pane",\n                        { attrs: { label: "编译日志", name: "log" } },\n                        [\n                          _c(\n                            "div",\n                            {\n                              directives: [\n                                {\n                                  name: "show",\n                                  rawName: "v-show",\n                                  value: _vm.loading,\n                                  expression: "loading",\n                                },\n                              ],\n                              staticClass: "loading-wrapper",\n                            },\n                            [_c("i", { staticClass: "el-icon-loading" })]\n                          ),\n                          _vm._v(" "),\n                          _c(\n                            "el-timeline",\n                            { key: _vm.timeline.length },\n                            _vm._l(_vm.timeline, function (tl, index) {\n                              return _c(\n                                "el-timeline-item",\n                                {\n                                  key: index,\n                                  attrs: {\n                                    timestamp: tl.timestamp,\n                                    placement: "top",\n                                    type: tl.type,\n                                  },\n                                },\n                                [\n                                  _c(\n                                    "el-card",\n                                    [\n                                      _c("strong", [_vm._v(_vm._s(tl.title))]),\n                                      _vm._v(" "),\n                                      _c(\n                                        "div",\n                                        {\n                                          staticStyle: { "margin-top": "16px" },\n                                        },\n                                        [_vm._v(_vm._s(tl.content))]\n                                      ),\n                                      _vm._v(" "),\n                                      _vm._l(tl.others, function (other) {\n                                        return _c("p", { key: other }, [\n                                          _vm._v(_vm._s(other)),\n                                        ])\n                                      }),\n                                    ],\n                                    2\n                                  ),\n                                ],\n                                1\n                              )\n                            }),\n                            1\n                          ),\n                        ],\n                        1\n                      ),\n                      _vm._v(" "),\n                      _c(\n                        "el-tab-pane",\n                        { attrs: { label: "渲染预览", name: "preview" } },\n                        [\n                          _c("div", { staticClass: "render-wrapper" }, [\n                            _c("div", { ref: "renderContainer" }),\n                          ]),\n                        ]\n                      ),\n                    ],\n                    1\n                  ),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n        ]\n      ),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/compile.vue?./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet%5B1%5D.rules%5B1%5D!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options\n}');
/***/},
/***/"./src/utils/scheduler.js":
/*!********************************!*\
  !*** ./src/utils/scheduler.js ***!
  \********************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass Scheduler {\n  constructor(delay = [1000, 3000]) {\n    this.isRunning = false;\n    this.tasks = [];\n    this.delay = delay;\n  }\n\n  add(task) {\n    this.tasks.push(() => {\n      return new Promise((resolve) => {\n        task();\n        setTimeout(() => {\n          resolve();\n        }, this.delay[0] + Math.random() * (this.delay[1] - this.delay[0]));\n      });\n    });\n    this.run();\n  }\n\n  async run() {\n    if (this.tasks.length === 0 || this.isRunning) {\n      this.isRunning = false;\n      return;\n    }\n    this.isRunning = true;\n    const task = this.tasks.shift();\n    await task();\n    await this.run();\n  }\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Scheduler);\n\n\n//# sourceURL=webpack://complie_template/./src/utils/scheduler.js?\n}');
/***/},
/***/"./src/views/Compile/compile.vue":
/*!***************************************!*\
  !*** ./src/views/Compile/compile.vue ***!
  \***************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _compile_vue_vue_type_template_id_a4ad38e6_scoped_true__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./compile.vue?vue&type=template&id=a4ad38e6&scoped=true */ "./src/views/Compile/compile.vue?vue&type=template&id=a4ad38e6&scoped=true");\n/* harmony import */ var _compile_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./compile.vue?vue&type=script&lang=js */ "./src/views/Compile/compile.vue?vue&type=script&lang=js");\n/* harmony import */ var _compile_vue_vue_type_style_index_0_id_a4ad38e6_lang_scss_scoped_true__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true */ "./src/views/Compile/compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true");\n/* harmony import */ var _node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! !../../../node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/runtime/componentNormalizer.js */ "./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/runtime/componentNormalizer.js");\n\n\n\n;\n\n\n/* normalize component */\n\nvar component = (0,_node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(\n  _compile_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_1__["default"],\n  _compile_vue_vue_type_template_id_a4ad38e6_scoped_true__WEBPACK_IMPORTED_MODULE_0__.render,\n  _compile_vue_vue_type_template_id_a4ad38e6_scoped_true__WEBPACK_IMPORTED_MODULE_0__.staticRenderFns,\n  false,\n  null,\n  "a4ad38e6",\n  null\n  \n)\n\n/* hot reload */\nif (false) // removed by dead control flow\n{ var api; }\ncomponent.options.__file = "src/views/Compile/compile.vue"\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (component.exports);\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/compile.vue?\n}');
/***/},
/***/"./src/views/Compile/compile.vue?vue&type=script&lang=js":
/*!***************************************************************!*\
  !*** ./src/views/Compile/compile.vue?vue&type=script&lang=js ***!
  \***************************************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_index_js_vue_loader_options_compile_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./compile.vue?vue&type=script&lang=js */ "./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=script&lang=js");\n /* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_index_js_vue_loader_options_compile_vue_vue_type_script_lang_js__WEBPACK_IMPORTED_MODULE_0__["default"]); \n\n//# sourceURL=webpack://complie_template/./src/views/Compile/compile.vue?\n}');
/***/},
/***/"./src/views/Compile/compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true":
/*!************************************************************************************************!*\
  !*** ./src/views/Compile/compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true ***!
  \************************************************************************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _node_modules_pnpm_mini_css_extract_plugin_2_9_2_webpack_5_101_0_node_modules_mini_css_extract_plugin_dist_loader_js_node_modules_pnpm_css_loader_7_1_2_webpack_5_101_0_node_modules_css_loader_dist_cjs_js_node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_pnpm_sass_loader_16_0_5_sass_1_89_2_webpack_5_101_0_node_modules_sass_loader_dist_cjs_js_node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_index_js_vue_loader_options_compile_vue_vue_type_style_index_0_id_a4ad38e6_lang_scss_scoped_true__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/.pnpm/mini-css-extract-plugin@2.9.2_webpack@5.101.0/node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/.pnpm/css-loader@7.1.2_webpack@5.101.0/node_modules/css-loader/dist/cjs.js!../../../node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/.pnpm/sass-loader@16.0.5_sass@1.89.2_webpack@5.101.0/node_modules/sass-loader/dist/cjs.js!../../../node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true */ "./node_modules/.pnpm/mini-css-extract-plugin@2.9.2_webpack@5.101.0/node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/.pnpm/css-loader@7.1.2_webpack@5.101.0/node_modules/css-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/.pnpm/sass-loader@16.0.5_sass@1.89.2_webpack@5.101.0/node_modules/sass-loader/dist/cjs.js!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=style&index=0&id=a4ad38e6&lang=scss&scoped=true");\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/compile.vue?\n}');
/***/},
/***/"./src/views/Compile/compile.vue?vue&type=template&id=a4ad38e6&scoped=true":
/*!*********************************************************************************!*\
  !*** ./src/views/Compile/compile.vue?vue&type=template&id=a4ad38e6&scoped=true ***!
  \*********************************************************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   render: () => (/* reexport safe */ _node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_loaders_templateLoader_js_ruleSet_1_rules_1_node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_index_js_vue_loader_options_compile_vue_vue_type_template_id_a4ad38e6_scoped_true__WEBPACK_IMPORTED_MODULE_0__.render),\n/* harmony export */   staticRenderFns: () => (/* reexport safe */ _node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_loaders_templateLoader_js_ruleSet_1_rules_1_node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_index_js_vue_loader_options_compile_vue_vue_type_template_id_a4ad38e6_scoped_true__WEBPACK_IMPORTED_MODULE_0__.staticRenderFns)\n/* harmony export */ });\n/* harmony import */ var _node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_loaders_templateLoader_js_ruleSet_1_rules_1_node_modules_pnpm_vue_loader_15_11_1_vue_compiler_sfc_3_5_18_css_loader_7_1_2_webpack_5_101_0_lodash_4_08391a3d3b433fadcc207c42207594cc_node_modules_vue_loader_lib_index_js_vue_loader_options_compile_vue_vue_type_template_id_a4ad38e6_scoped_true__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[1]!../../../node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./compile.vue?vue&type=template&id=a4ad38e6&scoped=true */ "./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/loaders/templateLoader.js??ruleSet[1].rules[1]!./node_modules/.pnpm/vue-loader@15.11.1_@vue+compiler-sfc@3.5.18_css-loader@7.1.2_webpack@5.101.0__lodash@4._08391a3d3b433fadcc207c42207594cc/node_modules/vue-loader/lib/index.js??vue-loader-options!./src/views/Compile/compile.vue?vue&type=template&id=a4ad38e6&scoped=true");\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/compile.vue?\n}');
/***/},
/***/"./src/views/Compile/config.js":
/*!*************************************!*\
  !*** ./src/views/Compile/config.js ***!
  \*************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   text: () => (/* binding */ text)\n/* harmony export */ });\n// Vue file content embedded directly\nconst text = `<template>\n  <div class="custom-component">\n    <h3>{{ title }}</h3>\n    <h4>props-subTitle: {{ subTitle }}</h4>\n    <p v-if="showDesc">{{ count }}</p>\n    <ul>\n      <li v-for="(item, index) in list" :key="index" class="list-item">\n        {{ index + 1 }}. {{ item }}\n      </li>\n    </ul>\n    <el-button @click="handleClick">Add</el-button>\n  </div>\n</template>\n<script>\nexport default {\n  name: "Example",\n  props: {\n    subTitle: String,\n  },\n  data() {\n    return {\n      title: "Vue 2 自定义组件",\n      list: ["基本信息", "报表数据", "统计分析"],\n      showDesc: true,\n      count: 0,\n    };\n  },\n  mounted() {\n    this.$emit("loaded", "oh loaded");\n  },\n  methods: {\n    handleClick() {\n      this.count++;\n      this.$emit("click", this.count);\n    },\n  },\n};\n<\/script>\n<style>\nh3 {\n  color: #f40;\n}\n</style>\n\n`;\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/config.js?\n}');
/***/},
/***/"./src/views/Compile/helper.js":
/*!*************************************!*\
  !*** ./src/views/Compile/helper.js ***!
  \*************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ComponentRender: () => (/* binding */ ComponentRender),\n/* harmony export */   LogStatus: () => (/* binding */ LogStatus)\n/* harmony export */ });\n/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vue */ "./node_modules/.pnpm/vue@2.7.16/node_modules/vue/dist/vue.runtime.esm.js");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ "./node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm-browser/v4.js");\n/* harmony import */ var vue_template_compiler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! vue-template-compiler */ "./node_modules/.pnpm/vue-template-compiler@2.7.16/node_modules/vue-template-compiler/browser.js");\n/* harmony import */ var vue_template_compiler__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(vue_template_compiler__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var element_ui__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! element-ui */ "./node_modules/.pnpm/element-ui@2.15.14_vue@2.7.16/node_modules/element-ui/lib/element-ui.common.js");\n/* harmony import */ var element_ui__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(element_ui__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n\nconst LogStatus = {\n  success: "success",\n  danger: "danger",\n};\n\nclass ComponentRender {\n  scopedId = "";\n  vueText = "";\n  originStructure = {\n    template: "",\n    script: "",\n    style: "",\n  };\n  vueStructure = {\n    template: "",\n    script: "",\n    style: "",\n  };\n  logCallback = () => {};\n  containerRef = null;\n  componentInstance = null;\n\n  constructor(containerRef, logCallback) {\n    this.containerRef = containerRef;\n    this.logCallback = logCallback || (() => {});\n\n    this.logCallback(\n      { status: { status: LogStatus.success, done: false }, done: false },\n      "创建渲染器",\n      this.containerRef.outerHTML\n    );\n\n    this.scopedId = `data-v-${(0,uuid__WEBPACK_IMPORTED_MODULE_1__["default"])().slice(0, 8)}`;\n    this.logCallback(\n      { status: { status: LogStatus.success, done: false }, done: false },\n      "生成scoped标识",\n      this.scopedId\n    );\n  }\n\n  get text() {\n    return this.vueText;\n  }\n\n  get structure() {\n    return this.vueStructure;\n  }\n\n  render(vueText, { props = {}, events = {} } = {}) {\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "开始渲染",\n      this.scopedId\n    );\n\n    this.vueText = vueText;\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "获取原始字符",\n      this.vueText\n    );\n\n    try {\n      // 1. 销毁原有实例\n      this.destroy();\n\n      // 2. 拆分结构\n      this.splitStructure();\n\n      // 3. template安全防卫\n      this.sanitizeTemplate();\n\n      // 6. 注入scoped标识\n      this.withScopedStyle();\n\n      // 4. 编译template\n      const parsedTemplate = this.parseTemplate();\n\n      // 5. 解析script\n      const parsedScript = this.parseScript();\n\n      // 7. 创建组件构造器\n      const ComponentConstructor = vue__WEBPACK_IMPORTED_MODULE_0__["default"].extend({\n        ...parsedScript,\n        render: parsedTemplate.render,\n        staticRenderFns: parsedTemplate.staticRenderFns,\n      });\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "创建组件构造器",\n        ComponentConstructor.toString()\n      );\n\n      // 8. 实例化组件\n      this.componentInstance = new ComponentConstructor({\n        propsData: {\n          ...props,\n        },\n      });\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "实例化组件",\n        JSON.stringify(this.componentInstance.$options)\n      );\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "挂载props",\n        JSON.stringify(props)\n      );\n\n      // 9. 挂载事件\n      for (let key in events) {\n        this.componentInstance.$on(key, events[key]);\n      }\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "挂载事件",\n        JSON.stringify(Object.keys(events))\n      );\n\n      // 10. 挂载到容器\n      this.componentInstance.$mount(this.containerRef);\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "挂载到容器",\n        this.containerRef.innerHTML\n      );\n      this.logCallback(\n        { status: LogStatus.success, done: true },\n        "渲染完成",\n        "前往【渲染预览】查看效果"\n      );\n    } catch (error) {\n      element_ui__WEBPACK_IMPORTED_MODULE_3__.Message.error(error);\n      this.logCallback(\n        { status: LogStatus.danger, done: true },\n        "出错了，渲染失败",\n        error\n      );\n      throw new Error(error);\n    }\n  }\n\n  /**\n   * 销毁已有实例\n   */\n  destroy() {\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "销毁已有实例",\n      this.componentInstance?.$options.name || "无实例"\n    );\n\n    if (!this.componentInstance) {\n      return;\n    }\n    this.componentInstance.$destroy();\n    this.containerRef.innerHTML = "";\n  }\n\n  /**\n   * 拆分结构\n   */\n  splitStructure() {\n    const getMatch = (text, reg) => {\n      const match = text.match(reg);\n      return match ? match[1].trim() : "";\n    };\n\n    const template = getMatch(this.vueText, /<template>([\\s\\S]*?)<\\/template>/);\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "拆分template",\n      template\n    );\n    const script = getMatch(this.vueText, /<script>([\\s\\S]*?)<\\/script>/);\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "拆分script",\n      script\n    );\n    const style = getMatch(this.vueText, /<style>([\\s\\S]*?)<\\/style>/);\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "拆分style",\n      style\n    );\n\n    Object.assign(this.originStructure, {\n      template,\n      script,\n      style,\n    });\n\n    Object.assign(this.vueStructure, {\n      template,\n      script,\n      style,\n    });\n  }\n\n  /**\n   * 模版安全防卫\n   */\n  sanitizeTemplate() {\n    const { template } = this.vueStructure;\n\n    // 1. 危险标签\n    const dangerTags = ["script", "iframe", "svg", "canvas", "video", "audio"];\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "检测template模版标签安全",\n      `目标标签：${JSON.stringify(dangerTags)}`,\n      `模版内容：${template}`\n    );\n    dangerTags.forEach((tag) => {\n      const regexp = new RegExp(`<\\/?${tag}[^>]*>`, "gi");\n      if (regexp.test(template)) {\n        throw new Error(`禁止使用${tag}标签`);\n      }\n    });\n\n    // 2. 危险指令v-html\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "检测template模版指令安全",\n      "目标指令：[v-html]",\n      `模版内容：${template}`\n    );\n    if (/v-html=/.test(template)) {\n      throw new Error(`禁止使用v-html指令`);\n    }\n\n    // 3. 危险事件\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "检测template模版事件安全",\n      "[]"\n    );\n    [].forEach((name) => {\n      const regexp = new RegExp(`@(${name})`, "gi");\n      if (regexp.test(template)) {\n        throw new Error(`禁止使用${name}事件`);\n      }\n    });\n  }\n\n  /**\n   * 解析template内容\n   */\n  parseTemplate() {\n    try {\n      const { template } = this.vueStructure;\n      const result = (0,vue_template_compiler__WEBPACK_IMPORTED_MODULE_2__.compile)(template);\n      if (result.errors.length > 0) {\n        throw new Error(\n          result.errors\n            .map((error, index) => `${index + 1}. ${error}`)\n            .join("\\n")\n        );\n      }\n\n      // 将render字符串转换为函数\n      const renderFunction = new Function("_c", "_v", "_s", result.render);\n      const staticRenderFns = result.staticRenderFns.map(\n        (fn) => new Function("_c", "_v", "_s", fn)\n      );\n\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "解析template内容",\n        "生成render函数",\n        `render函数：${renderFunction.toString()}`\n      );\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "解析template内容",\n        "生成staticRenderFns函数",\n        `staticRenderFns函数：${staticRenderFns.map((fn) => fn.toString())}`\n      );\n\n      return {\n        render: renderFunction,\n        staticRenderFns: staticRenderFns,\n      };\n    } catch (error) {\n      throw new Error(error);\n    }\n  }\n\n  /**\n   * 解析script内容\n   */\n  parseScript() {\n    this.logCallback(\n      { status: LogStatus.success, done: false },\n      "解析script内容",\n      `script内容：${this.vueStructure.script}`\n    );\n    try {\n      const { script } = this.vueStructure;\n      const optionStr = script.replace(/^export(\\s)+default/, "");\n      const getOption = new Function(`return ${optionStr}`);\n      const option = getOption();\n      if (option.data && typeof option.data !== "function") {\n        option.data = () => option.data;\n      }\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "解析script内容",\n        `option：${JSON.stringify(option)}`\n      );\n      return option;\n    } catch (error) {\n      throw new Error(error);\n    }\n  }\n\n  /**\n   * 注入style内容\n   */\n  withScopedStyle() {\n    try {\n      const withTemplate = (template, id) => {\n        const parser = new DOMParser();\n        const html = parser.parseFromString(template, "text/html");\n        const el = html.body.firstChild;\n        el.setAttribute(id, "");\n        return el.outerHTML;\n      };\n      const withStyle = (style, id) => {\n        const scopedStyle = `[${id}]{${style}}`;\n        const styleElement = document.createElement("style");\n        styleElement.type = "text/css";\n        styleElement.textContent = scopedStyle;\n        document.head.appendChild(styleElement);\n        return scopedStyle;\n      };\n\n      const { template, style } = this.vueStructure;\n\n      // 1. template attribute 注入\n      this.vueStructure.template = withTemplate(template, this.scopedId);\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "template注入scopedId",\n        `原：${template}`,\n        `现：${this.vueStructure.template}`\n      );\n      // 2. style样式属性注入\n      this.vueStructure.style = withStyle(style, this.scopedId);\n      this.logCallback(\n        { status: LogStatus.success, done: false },\n        "style注入scopedId",\n        `原：${style}`,\n        `现：${this.vueStructure.style}`\n      );\n    } catch (error) {\n      throw new Error(error);\n    }\n  }\n}\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/helper.js?\n}');
/***/},
/***/"./src/views/Compile/index.js":
/*!************************************!*\
  !*** ./src/views/Compile/index.js ***!
  \************************************/
/***/(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _compile_vue__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./compile.vue */ "./src/views/Compile/compile.vue");\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (_compile_vue__WEBPACK_IMPORTED_MODULE_0__["default"]);\n\n\n//# sourceURL=webpack://complie_template/./src/views/Compile/index.js?\n}');
/***/}}]);